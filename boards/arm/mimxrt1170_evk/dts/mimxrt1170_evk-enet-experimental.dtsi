/*
 * Copyright 2021,2023 NXP
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/ {
	soc {
		// /delete-node/ ethernet@40424000;
		/delete-node/ ethernet@40420000;

		// enet: ethernet@40424000 {
		// 	compatible = "nxp,enet";
		// 	reg = <0x40424000 0x628>;
		// 	clocks = <&ccm IMX_CCM_ENET_CLK 0 0>;
		// 	enet_mac: ethernet {
		// 		status = "disabled";
		// 		compatible = "nxp,enet-mac";
		// 		interrupts = <137 0>;
		// 		interrupt-names = "COMMON";
		// 		nxp,mdio = <&enet_mdio>;
		// 		nxp,ptp-clock = <&enet_ptp_clock>;
		// 		phy-connection-type = "rmii";
		// 	};
		// 	enet_mdio: mdio {
		// 		status = "disabled";
		// 		compatible = "nxp,enet-mdio";
		// 		#address-cells = <1>;
		// 		#size-cells = <0>;
		// 	};
		// 	enet_ptp_clock: ptp_clock {
		// 		status = "disabled";
		// 		compatible = "nxp,enet-ptp-clock";
		// 		interrupts = <138 0>;
		// 		clocks = <&ccm IMX_CCM_ENET_CLK 0 0>;
		// 	};
		// };

		enet1g: ethernet@40420000 {
			compatible = "nxp,enet";
			reg = <0x40420000 0x628>;
			clocks = <&ccm IMX_CCM_ENET_CLK 0 0>;
			enet1g_mac: ethernet {
				status = "disabled";
				compatible = "nxp,enet-mac";
				interrupts = <141 0>;
				interrupt-names = "COMMON";
				nxp,mdio = <&enet1g_mdio>;
				nxp,ptp-clock = <&enet1g_ptp_clock>;
				phy-connection-type = "gmii";
			};
			enet1g_mdio: mdio {
				status = "disabled";
				compatible = "nxp,enet-mdio";
				#address-cells = <1>;
				#size-cells = <0>;
			};
			// The devkit does not have ptp setup on the ENET1G
			enet1g_ptp_clock: ptp_clock {
				status = "disabled";
				compatible = "nxp,enet-ptp-clock";
			};
		};
	};
};

// &enet_mac {
// 	//status = "okay";
// 	pinctrl-0 = <&pinmux_enet>;
// 	pinctrl-names = "default";
// 	phy-handle = <&phy>;
// };

// &enet_mdio {
// 	//status = "okay";
// 	pinctrl-0 = <&pinmux_enet_mdio>;
// 	pinctrl-names = "default";
// 	phy: phy@2 {
// 		status = "okay";
// 		compatible = "microchip,ksz8081";
// 		reg = <2>;
// 		mc,reset-gpio = <&gpio12 12 GPIO_ACTIVE_HIGH>;			// ENET_RST
// 		mc,interrupt-gpio = <&gpio9 11 GPIO_ACTIVE_HIGH>;		// ENET_INT
// 		mc,interface-type = "rmii";
// 	};
// };

// &enet_ptp_clock {
// 	//status = "okay";
// 	pinctrl-0 = <&pinmux_ptp>;
// 	pinctrl-names = "default";
// };

&enet1g_mac {
	status = "okay";
	pinctrl-0 = <&pinmux_enet1g>;
	pinctrl-names = "default";
	phy-handle = <&phy1g>;
};

&enet1g_mdio {
	status = "okay";
	pinctrl-0 = <&pinmux_enet1g_mdio>;
	pinctrl-names = "default";
	phy1g: phy1g@9 {
		status = "okay";
		compatible = "ethernet-phy";
		reg = <9>;
	};
};

&pinctrl {
	/delete-node/ pinmux_ptp;
	/delete-node/ pinmux_enet;

	pinmux_enet: pinmux_enet {
		group0 {
			pinmux = <&iomuxc_gpio_disp_b2_05_enet_ref_clk>;	// ENET_TX_REF_CLK
			bias-disable;
			drive-strength = "high";
			slew-rate = "fast";
			input-enable;
		};
		group1 {
			pinmux = <&iomuxc_gpio_disp_b2_02_enet_tdata00>,	// ENET_TXD0
				<&iomuxc_gpio_disp_b2_03_enet_tdata01>,		// ENET_TXD1
				<&iomuxc_gpio_disp_b2_04_enet_tx_en>,		// ENET_TXEN
				<&iomuxc_gpio_disp_b2_06_enet_rdata00>,		// ENET_RXD0
				<&iomuxc_gpio_disp_b2_07_enet_rdata01>,		// ENET_RXD1
				<&iomuxc_gpio_disp_b2_09_enet_rx_er>,		// ENET_RXER
				<&iomuxc_gpio_disp_b2_08_enet_rx_en>;		// ENET_CRS_DV
			drive-strength = "high";
			bias-pull-up;
			slew-rate = "fast";
		};
	};

	pinmux_enet_mdio: pinmux_enet_mdio {
		group0 {
			pinmux = <&iomuxc_gpio_ad_32_enet_mdc>,			// ENET_MDC
				<&iomuxc_gpio_ad_33_enet_mdio>,			// ENET_MDIO
				<&iomuxc_lpsr_gpio_lpsr_12_gpio12_io12>,	// ENET_RST
				<&iomuxc_gpio_ad_12_gpio9_io11>;		// ENET_INT
			drive-strength = "high";
			bias-pull-up;
			slew-rate = "fast";
		};
	};

	pinmux_ptp: pinmux_ptp {
		group0 {
			pinmux = <&iomuxc_gpio_ad_34_enet_1588_event0_in>,	// 1588_EVENT0_IN
				<&iomuxc_gpio_ad_35_enet_1588_event0_out>;	// 1588_EVENT0_OUT
			drive-strength = "high";
			slew-rate = "slow";
		};
	};

	pinmux_enet1g: pinmux_enet1g {
		group0 {
			pinmux = <&iomuxc_gpio_disp_b1_11_enet_1g_tx_clk_io>,	// ENET_RGMII_TXC
				<&iomuxc_gpio_disp_b1_01_enet_1g_rx_clk>;	// ENET_RGMII_RXC
			bias-disable;
			drive-strength = "high";
			slew-rate = "fast";
			input-enable;
		};
		group1 {
			pinmux = <&iomuxc_gpio_disp_b1_09_enet_1g_tdata00>,	// ENET_RGMII_TXD0
				<&iomuxc_gpio_disp_b1_08_enet_1g_tdata01>,	// ENET_RGMII_TXD1
				<&iomuxc_gpio_disp_b1_07_enet_1g_tdata02>,	// ENET_RGMII_TXD2
				<&iomuxc_gpio_disp_b1_06_enet_1g_tdata03>,	// ENET_RGMII_TXD3
				<&iomuxc_gpio_disp_b1_10_enet_1g_tx_en>,	// ENET_RGMII_TX_EN
				<&iomuxc_gpio_disp_b1_02_enet_1g_rdata00>,	// ENET_RGMII_RXD0
				<&iomuxc_gpio_disp_b1_03_enet_1g_rdata01>,	// ENET_RGMII_RXD1
				<&iomuxc_gpio_disp_b1_04_enet_1g_rdata02>,	// ENET_RGMII_RXD2
				<&iomuxc_gpio_disp_b1_05_enet_1g_rdata03>,	// ENET_RGMII_RXD3
				<&iomuxc_gpio_disp_b1_00_enet_1g_rx_en>;	// ENET_RGMII_RX_EN
			drive-strength = "high";
			bias-pull-up;
			slew-rate = "fast";
		};
	};

	pinmux_enet1g_mdio: pinmux_enet1g_mdio {
		group0 {
			pinmux = <&iomuxc_gpio_emc_b2_19_enet_1g_mdc>,		// ENET_RGMII_MDC
				<&iomuxc_gpio_emc_b2_20_enet_1g_mdio>,		// ENET_RGMII_MDIO
				<&iomuxc_gpio_disp_b2_13_gpio11_io14>,		// ETHPHY_RST_B
				<&iomuxc_gpio_disp_b2_12_gpio11_io13>;		// RGMII1_PHY_INTB
			drive-strength = "high";
			bias-pull-up;
			slew-rate = "fast";
		};
	};
};
